INSERT INTO transforms (category_id, slug, name, description, icon, tier, overview, tag)
VALUES (
    6,
    'accordion',
    'Accordion',
    'Accessible accordion with smooth height animation and keyboard navigation.',
    'expand_circle_down',
    'Free',
    $$A fully accessible accordion component with smooth height animations. Built for FAQ sections, feature lists, documentation, and anywhere you need collapsible content.

### How it works

Write your content as alternating pairs - a header element followed by a panel element. The accordion restructures them into collapsible sections with proper ARIA attributes, keyboard navigation, and animated expand/collapse transitions.

### Smooth animation

Uses CSS Grid's grid-template-rows transition from 0fr to 1fr for buttery smooth height animation. No JavaScript height calculations, no fixed max-height hacks. The panel expands to its natural content height with a clean easing curve.

### Accessibility

Full WAI-ARIA accordion pattern. Headers are focusable buttons with aria-expanded state. Panels have role="region" with proper labelling. Keyboard navigation supports Arrow Up/Down between headers, Home/End to jump to first/last, and Enter/Space to toggle.

### Modes

By default, only one panel can be open at a time - opening one closes the others. Enable multiple mode to let users open as many panels as they want simultaneously.

### Styled and unstyled

Ships with a clean default style - subtle borders, smooth color transitions on hover, and a plus/minus icon that animates between states. Disable styled mode to strip all visual styling and apply your own design. The animation and accessibility features work either way.$$,
    NULL
)
RETURNING id;

-- Use the returned id as {transform_id} below:

INSERT INTO versions (transform_id, version, code, style, js, css, config, usage, previews)
VALUES (
    {transform_id},
    '1.0.0',
    $$const prefix = 'ot-accordion';
const uid = Math.random().toString(36).substring(2, 7);

this.items = [];

this.parse = () =>
{
    const children = [...node.children];
    const items = [];

    for(let i = 0; i < children.length; i += 2)
    {
        items.push({
            header: children[i],
            panel: children[i + 1]
        });
    }

    return items;
};

this.element = (tag, className, parent) =>
{
    const el = document.createElement(tag);
    el.className = className;
    parent.appendChild(el);
    return el;
};

this.item = (parsed, index) =>
{
    const active = index === data['active'];
    const wrapper = this.element('div', prefix + '-item', node);

    if(active)
    {
        wrapper.classList.add(prefix + '-open');
    }

    const header = this.element('button', prefix + '-header', wrapper);
    header.innerHTML = parsed.header.innerHTML;
    header.setAttribute('id', prefix + '-header-' + uid + '-' + index);
    header.setAttribute('aria-expanded', active ? 'true' : 'false');
    header.setAttribute('aria-controls', prefix + '-panel-' + uid + '-' + index);

    if(data['icon'])
    {
        const icon = this.element('span', prefix + '-icon', header);
        icon.setAttribute('aria-hidden', 'true');
    }

    const region = this.element('div', prefix + '-region', wrapper);
    region.style.setProperty('--duration', data['duration'] + 'ms');

    const panel = this.element('div', prefix + '-panel', region);
    const content = this.element('div', prefix + '-content', panel);
    content.innerHTML = parsed.panel.innerHTML;
    panel.setAttribute('id', prefix + '-panel-' + uid + '-' + index);
    panel.setAttribute('role', 'region');
    panel.setAttribute('aria-labelledby', prefix + '-header-' + uid + '-' + index);

    return { wrapper, header, region, panel };
};

this.toggle = (index) =>
{
    const item = this.items[index];
    const open = item.wrapper.classList.contains(prefix + '-open');

    if(!data['multiple'] && !open)
    {
        for(let i = 0; i < this.items.length; i++)
        {
            if(i !== index)
            {
                this.close(i);
            }
        }
    }

    if(open)
    {
        this.close(index);
    }
    else
    {
        this.open(index);
    }
};

this.open = (index) =>
{
    const item = this.items[index];
    item.wrapper.classList.add(prefix + '-open');
    item.header.setAttribute('aria-expanded', 'true');
};

this.close = (index) =>
{
    const item = this.items[index];
    item.wrapper.classList.remove(prefix + '-open');
    item.header.setAttribute('aria-expanded', 'false');
};

this.keyboard = (e) =>
{
    const headers = this.items.map(item => item.header);
    const index = headers.indexOf(e.target);

    if(index === -1)
    {
        return;
    }

    let target = -1;

    if(e.key === 'ArrowDown')
    {
        target = (index + 1) % this.items.length;
    }
    else if(e.key === 'ArrowUp')
    {
        target = (index - 1 + this.items.length) % this.items.length;
    }
    else if(e.key === 'Home')
    {
        target = 0;
    }
    else if(e.key === 'End')
    {
        target = this.items.length - 1;
    }

    if(target === -1)
    {
        return;
    }

    e.preventDefault();
    headers[target].focus();
};

this.events = () =>
{
    this.items.forEach((item, index) =>
    {
        item.header.addEventListener('click', () => this.toggle(index));
    });

    node.addEventListener('keydown', (e) => this.keyboard(e));
};

this.build = () =>
{
    const parsed = this.parse();

    node.innerHTML = '';
    node.classList.add(prefix);

    if(data['styled'])
    {
        node.classList.add(prefix + '-styled');
    }

    parsed.forEach((item, index) =>
    {
        this.items.push(this.item(item, index));
    });

    this.events();
};

this.build();$$,
    $$/* Base */
.ot-accordion {
    display: flex;
    flex-direction: column;
    width: 100%;
}

/* Header */
.ot-accordion-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    width: 100%;
    background: none;
    border: none;
    cursor: pointer;
    font-family: inherit;
    font-size: inherit;
    color: inherit;
    text-align: left;
    outline: none;
    gap: var(--ot-spacing-s);
}

.ot-accordion-header:focus-visible {
    outline: 2px solid var(--ot-brand);
    outline-offset: -2px;
    border-radius: var(--ot-radius-s);
}

/* Icon */
.ot-accordion-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    width: 20px;
    height: 20px;
    position: relative;
    transition: transform var(--duration, 300ms) ease;
}

.ot-accordion-icon::before,
.ot-accordion-icon::after {
    content: '';
    position: absolute;
    background: currentColor;
    border-radius: 1px;
}

.ot-accordion-icon::before {
    width: 12px;
    height: 2px;
}

.ot-accordion-icon::after {
    width: 2px;
    height: 12px;
    transition: transform var(--duration, 300ms) ease;
}

.ot-accordion-open .ot-accordion-icon::after {
    transform: rotate(90deg);
}

/* Region â€” grid height animation */
.ot-accordion-region {
    display: grid;
    grid-template-rows: 0fr;
    transition: grid-template-rows var(--duration, 300ms) ease;
}

.ot-accordion-open .ot-accordion-region {
    grid-template-rows: 1fr;
}

/* Panel */
.ot-accordion-panel {
    overflow: hidden;
}

/* Styled */
.ot-accordion-styled .ot-accordion-item {
    border-bottom: 1px solid var(--ot-bg-2-border);
}

.ot-accordion-styled .ot-accordion-header {
    padding: var(--ot-spacing-m) 0;
    font-family: var(--ot-font-primary), sans-serif;
    font-size: 15px;
    font-weight: 500;
    color: var(--ot-text-2);
    transition: color 0.2s ease;
}

.ot-accordion-styled .ot-accordion-header:hover,
.ot-accordion-styled .ot-accordion-open .ot-accordion-header {
    color: var(--ot-text-1);
}

.ot-accordion-styled .ot-accordion-panel {
    font-family: var(--ot-font-primary), sans-serif;
    font-size: var(--ot-size-m);
    color: var(--ot-text-2);
    line-height: 1.6;
}

.ot-accordion-styled .ot-accordion-content {
    padding-bottom: var(--ot-spacing-m);
}

/* Reduced motion */
@media (prefers-reduced-motion: reduce) {
    .ot-accordion-region {
        transition: none;
    }

    .ot-accordion-icon::after {
        transition: none;
    }
}$$,
    NULL,
    NULL,
    '{"multiple": {"type": "boolean", "value": false, "description": "Allow multiple panels open at once"}, "active": {"type": "number", "value": -1, "description": "Index of initially open panel, -1 for none"}, "duration": {"type": "number", "value": 300, "description": "Animation duration in milliseconds"}, "icon": {"type": "boolean", "value": true, "description": "Show plus/minus toggle icon"}, "styled": {"type": "boolean", "value": true, "description": "Apply default OneType styling"}}'::jsonb,
    $$<div ot="accordion">
    <div>What is OneType Transforms?</div>
    <div>A collection of standalone UI components you can add to any website with a single script tag. No frameworks, no build tools.</div>

    <div>How does pricing work?</div>
    <div>Free transforms are always free. Pro transforms require a Pro or Agency subscription for production use.</div>

    <div>Can I use it with any platform?</div>
    <div>Yes. Transforms work with any website builder, CMS, or custom code. Just add the script tag and use HTML attributes.</div>
</div>$$,
    ARRAY[
        $$// Default
<style>
    .default { max-width: 560px; margin: 0 auto; padding: var(--ot-spacing-l) var(--ot-spacing-m); }
    .default .title { font-size: 22px; font-weight: 700; color: var(--ot-text-1); margin-bottom: var(--ot-spacing-l); text-align: center; }
</style>

<div class="default">
    <div class="title">Frequently Asked Questions</div>
    <div ot="accordion" ot-active="0">
        <div>What is OneType Transforms?</div>
        <div>A collection of standalone UI components delivered via CDN. Add a script tag, use HTML attributes, and your components are live. No frameworks, no build tools, no complexity.</div>

        <div>How do I install it?</div>
        <div>Add a single script tag to your page. Each transform is activated with an HTML attribute like ot="accordion". Configuration is done through ot- prefixed attributes directly in your markup.</div>

        <div>Does it work with Webflow?</div>
        <div>Yes. Transforms work with Webflow, WordPress, Squarespace, Framer, and any other platform that lets you add custom code. There is also a dedicated Webflow Designer Extension.</div>

        <div>Can I cancel my subscription?</div>
        <div>Pro is a one-time lifetime purchase with no recurring fees. Agency is monthly and can be cancelled anytime from your account settings.</div>

        <div>Is there a free tier?</div>
        <div>Yes. Several transforms are completely free with no limitations. Pro transforms require a paid plan for production websites.</div>
    </div>
</div>$$,
        $$// Multiple
<style>
    .multiple { max-width: 560px; margin: 0 auto; padding: var(--ot-spacing-l) var(--ot-spacing-m); }
    .multiple .title { font-size: 22px; font-weight: 700; color: var(--ot-text-1); margin-bottom: var(--ot-spacing-l); text-align: center; }
</style>

<div class="multiple">
    <div class="title">Product Features</div>
    <div ot="accordion" ot-multiple="true" ot-active="0">
        <div><i>bolt</i> Performance</div>
        <div>Transforms are lightweight and load only what is needed. External libraries are fetched on demand when a transform is first used. No bloated bundles, no wasted bandwidth.</div>

        <div><i>lock</i> Security</div>
        <div>All scripts are served over HTTPS from our CDN. No cookies, no tracking, no data collection. Your visitors stay safe and private.</div>

        <div><i>code</i> Developer Friendly</div>
        <div>Clean HTML attributes for configuration. No JavaScript API to learn. Works with any tech stack. Copy the example, paste it into your site, done.</div>

        <div><i>palette</i> Customizable</div>
        <div>Every transform uses CSS variables for styling. Override colors, spacing, fonts, and more. Use the styled mode for instant results, or disable it and build your own look.</div>
    </div>
</div>$$,
        $$// Unstyled
<style>
    .unstyled { max-width: 560px; margin: 0 auto; padding: var(--ot-spacing-l) var(--ot-spacing-m); }
    .unstyled .title { font-size: 22px; font-weight: 700; color: var(--ot-text-1); margin-bottom: var(--ot-spacing-l); text-align: center; }
    .unstyled .ot-accordion-item { background: var(--ot-bg-2); border: 1px solid var(--ot-bg-2-border); border-radius: var(--ot-radius-l); margin-bottom: var(--ot-spacing-s); overflow: hidden; }
    .unstyled .ot-accordion-header { padding: var(--ot-spacing-m) var(--ot-spacing-m); font-family: var(--ot-font-primary), sans-serif; font-size: 14px; font-weight: 600; color: var(--ot-text-1); }
    .unstyled .ot-accordion-content { padding: 0 var(--ot-spacing-m) var(--ot-spacing-m); font-family: var(--ot-font-primary), sans-serif; font-size: var(--ot-size-m); color: var(--ot-text-2); line-height: 1.6; }
    .unstyled .ot-accordion-icon { color: var(--ot-text-2); }
</style>

<div class="unstyled">
    <div class="title">Custom Styled Cards</div>
    <div ot="accordion" ot-styled="false" ot-active="0">
        <div>Getting Started</div>
        <div>Create an account, pick a plan, and add the script tag to your website. You will be up and running in under five minutes.</div>

        <div>Integration Guide</div>
        <div>Transforms work with any HTML page. For Webflow users, install the Designer Extension for a visual drag-and-drop experience.</div>

        <div>API Reference</div>
        <div>Configuration is done through HTML attributes. Each transform documents its available options with types and default values.</div>
    </div>
</div>$$
    ]
);
